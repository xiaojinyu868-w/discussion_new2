# 需求文档: 用户管理与平台商业化系统

## 介绍

本需求文档定义 MeetMind 会议智能助手平台的用户管理系统和商业化功能。目标是将产品从 Demo 阶段推向正式上线，实现用户注册登录、数据持久化、使用配额管理和 VIP 订阅等核心功能。

### 核心目标
1. **用户体系**：支持用户注册、登录、个人中心
2. **数据持久化**：会议记录、转写内容、生成图片的永久存储
3. **配额与计费**：免费额度 + VIP 订阅模式
4. **用户体验**：确保流畅的使用体验和清晰的付费引导

---

## 需求

### 需求 1 - 用户注册与登录

**用户故事：** 作为新用户，我希望能够快速注册并登录平台，以便保存我的会议记录和使用历史。

#### 验收标准

1. When 用户访问平台首页时，系统应当显示登录/注册入口。
2. When 用户选择注册时，系统应当支持以下注册方式：
   - 手机号 + 验证码注册
   - 邮箱 + 密码注册
   - 微信扫码登录（可选，后续迭代）
3. When 用户完成注册后，系统应当自动登录并跳转到主界面。
4. When 已注册用户访问平台时，系统应当支持手机号/邮箱 + 密码登录。
5. When 用户登录成功后，系统应当生成 JWT Token 并在后续请求中验证身份。
6. When 用户选择"记住登录"时，系统应当在 7 天内保持登录状态。

---

### 需求 2 - 用户个人中心

**用户故事：** 作为已登录用户，我希望能够查看和管理我的账户信息、使用记录和订阅状态。

#### 验收标准

1. When 用户点击头像/个人中心入口时，系统应当显示个人中心页面。
2. 个人中心应当包含以下信息：
   - 用户基本信息（头像、昵称、手机号/邮箱）
   - 当前会员等级（免费用户/VIP）
   - 使用配额状态（剩余生图次数、本月使用量）
   - VIP 到期时间（如适用）
3. When 用户修改个人信息后，系统应当实时保存并更新显示。
4. When 用户点击"我的会议"时，系统应当显示历史会议记录列表。

---

### 需求 3 - 会议数据持久化存储

**用户故事：** 作为用户，我希望我的会议记录、转写内容和生成的图片能够永久保存，以便日后查阅。

#### 验收标准

1. When 用户开始新会议时，系统应当创建会议记录并关联到用户账户。
2. When 转写内容产生时，系统应当实时保存到数据库。
3. When 用户生成可视化图片时，系统应当将图片保存到对象存储（如阿里云 OSS）并记录 URL。
4. When 用户查看历史会议时，系统应当展示：
   - 会议标题（可编辑）
   - 会议时间
   - 会议时长
   - 转写内容预览
   - 生成的洞察和图片
5. When 用户删除会议记录时，系统应当软删除数据（保留 30 天后彻底删除）。
6. When 用户导出会议记录时，系统应当支持 Word/PDF 格式下载。

---

### 需求 4 - 使用配额管理

**用户故事：** 作为平台运营方，我需要控制用户的资源使用量，确保成本可控的同时提供良好的免费体验。

#### 验收标准

1. **免费用户配额**：
   - 语音转录：无限制（核心功能免费）
   - AI 洞察（inner_os/brainstorm/stop_talking 技能）：每日 20 次
   - 图片生成（chart/creative/poster）：每月 3 次
   - 会议问答：每日 50 次
   - 会议存储：最多保存 10 场会议

2. **VIP 用户配额**：
   - 语音转录：无限制
   - AI 洞察：无限制
   - 图片生成：每月 5 次
   - 会议问答：无限制
   - 会议存储：无限制

3. **现有技能说明**：
   - `inner_os`：内心OS洞察，分析会议中的潜台词
   - `brainstorm`：头脑风暴，生成创意想法
   - `stop_talking`：跑题检测，提醒回归主题

4. **可视化类型说明**：
   - `chart`：数据图表（支持 radar/flowchart/architecture/bar/line）
   - `creative`：创意图像
   - `poster`：逻辑海报

3. When 用户使用某功能时，系统应当检查并扣减对应配额。
4. When 用户配额不足时，系统应当：
   - 显示友好的提示信息
   - 引导用户升级 VIP 或等待配额刷新
5. When 每日/每月配额刷新时间到达时，系统应当自动重置对应配额。

---

### 需求 5 - VIP 订阅系统

**用户故事：** 作为付费意愿用户，我希望能够便捷地订阅 VIP 服务，获得更多功能和配额。

#### 验收标准

1. **VIP 定价方案**：
   - 月度 VIP：¥29/月
   - 季度 VIP：¥69/季（约 ¥23/月，省 18 元）
   - 年度 VIP：¥199/年（约 ¥16.6/月，省 149 元）

2. When 用户点击"升级 VIP"时，系统应当展示 VIP 权益对比和定价方案。
3. When 用户选择订阅方案后，系统应当跳转到支付页面（支持微信支付/支付宝）。
4. When 支付成功后，系统应当：
   - 立即更新用户 VIP 状态
   - 重置配额到 VIP 标准
   - 发送订阅成功通知
5. When VIP 即将到期（前 3 天）时，系统应当发送续费提醒。
6. When VIP 到期后，系统应当：
   - 将用户降级为免费用户
   - 保留历史数据但限制新功能使用

---

### 需求 6 - 安全与合规

**用户故事：** 作为用户，我希望我的账户和数据是安全的，隐私得到保护。

#### 验收标准

1. When 用户密码存储时，系统应当使用 bcrypt 加密存储。
2. When 用户登录失败超过 5 次时，系统应当锁定账户 15 分钟。
3. When 用户请求 API 时，系统应当验证 JWT Token 有效性。
4. When 用户访问他人数据时，系统应当返回 403 禁止访问。
5. When 用户注销账户时，系统应当在 7 天后彻底删除所有数据。
6. 系统应当符合《个人信息保护法》要求，提供隐私政策和用户协议。

---

### 需求 7 - 平台上线前的体验优化

**用户故事：** 作为用户，我希望平台使用流畅、界面美观、功能稳定。

#### 验收标准

1. When 页面加载时，系统应当在 3 秒内完成首屏渲染。
2. When 转写结果返回时，系统应当在 2 秒内显示（已优化）。
3. When 网络异常时，系统应当显示友好的错误提示和重试按钮。
4. When 用户未登录访问需登录功能时，系统应当引导到登录页。
5. 系统应当支持移动端响应式布局。
6. 系统应当提供新手引导，帮助用户快速上手。

---

## 附录：功能优先级

| 优先级 | 功能 | 说明 |
|--------|------|------|
| P0 | 用户注册/登录 | 上线必备 |
| P0 | 数据持久化 | 上线必备 |
| P0 | 基础配额管理 | 成本控制 |
| P1 | VIP 订阅 | 商业化核心 |
| P1 | 个人中心 | 用户体验 |
| P2 | 微信登录 | 降低注册门槛 |
| P2 | 新手引导 | 提升留存 |

---

## 附录：成本估算

| 功能 | 单次成本 | 免费用户月成本 | VIP 用户月成本 |
|------|----------|----------------|----------------|
| 语音转录（通义听悟） | ¥0.01/分钟 | ~¥3（5小时） | ~¥12（20小时） |
| AI 洞察（Qwen） | ¥0.002/次 | ~¥1.2（600次） | ~¥6（3000次） |
| 图片生成（第三方中转） | ¥1/张 | ¥3（3张） | ¥5（5张） |
| **合计** | - | **~¥7.2** | **~¥23** |

VIP 定价 ¥29/月，毛利约 ¥6（可持续商业模式）。

> 注：当前使用第三方中转 Google Imagen API，成本 ¥1/张
